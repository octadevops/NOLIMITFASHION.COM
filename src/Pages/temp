import React, { useEffect, useState } from "react";
import Logo from "../assets/NLM LOGO.png";
import NLM from "../assets/nolimit.jpg";
import { Link } from "react-router-dom";
import SLF from "../assets/SL_flag.png";
import UAEF from "../assets/UAE_flag.png";
import axios from "axios";

const Index = () => {
  const [allowed, setAllowed] = useState(null); // null initially to show loading state

  useEffect(() => {
    const fetchLocation = async () => {
      try {
        const response = await axios.get(
          "https://ipinfo.io?token=518c2f755dfb5a"
        ); // Replace with your GeoIP API endpoint and token
        const { country } = response.data;
        if (country === "LK") {
          // Replace 'US' with the desired country code
          setAllowed(true);
        } else {
          setAllowed(false);
        }
      } catch (error) {
        console.error("Error fetching location:", error);
        setAllowed(false);
      }
    };

    fetchLocation();
  }, []);

  if (allowed === null) {
    return (
      <div className="flex items-center justify-center min-h-screen bg-gray-200 text-gray-700 text-2xl">
        Loading...
      </div>
    );
  }

  if (!allowed) {
    return (
      <div className="flex items-center justify-center min-h-screen bg-red-500 text-white text-2xl">
        Access Denied
      </div>
    );
  }
  return (
    <div className="bg-[#33383F] w-full max-h-screen text-white flex flex-col items-center justify-center text-center">
      <img
        src={NLM}
        alt="NLM Image"
        className="bg-cover object-cover w-full h-screen absolute opacity-10"
      />

      <div className="relative flex flex-col items-center justify-center h-screen">
        <div className="py-4 flex flex-col justify-center items-center px-4">
          <img src={Logo} alt="Logo" className="md:w-[400px] w-[300px] pb-4" />
          <p className="text-2xl font-semibold">
            Welcome to Nolimit Fashion Chain
          </p>
          <p className="text-xl pt-10">Please select the region</p>
        </div>
        <div className="flex md:gap-10 gap-5 px-10">
          <a
            href="https://nolimit.lk"
            className="px-6 py-2 bg-white bg-opacity-10 bg-blur-md rounded-lg text-xl text-white font-semibold hover:bg-white hover:text-white hover:bg-opacity-40 duration-300 md:w-[250px] w-[150px] "
          >
            <img
              src={SLF}
              alt="SL Flag"
              className="w-[200px] hover:animate-pulse duration-300"
            />
            Sri Lanka
          </a>
          <Link to={"/home"}>
            <p className="px-6 py-2 bg-white bg-opacity-10 bg-blur-md rounded-lg text-xl text-white font-semibold hover:bg-white hover:text-white hover:bg-opacity-40 duration-300 md:w-[250px] w-[150px] ">
              <img
                src={UAEF}
                alt="UAE Flag"
                className="w-[200px] hover:animate-pulse duration-300"
              />
              UAE
            </p>
          </Link>
        </div>
      </div>
    </div>
  );
};

export default Index;
